---
import { getCollection } from 'astro:content';
import GameLayout from '../layouts/GameLayout.astro';
import GameCard from '../components/GameCard.astro';
import HeroSection from '../components/HeroSection.astro';

const games = (await getCollection('games')).sort(
  (a, b) => new Date(b.data.generatedAt).getTime() - new Date(a.data.generatedAt).getTime()
);

// ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ é¸å®šï¼ˆæœ€åˆã®1ä»¶ï¼‰
const [featured, ...otherGames] = games;
---

<GameLayout title="ãƒ›ãƒ¼ãƒ ">
  {games.length === 0 ? (
    <p class="empty">ã¾ã è¨˜äº‹ãŒãªã„ã§ã€‚`npm run generate` ã§ç”Ÿæˆã—ã¦ãªï¼</p>
  ) : (
    <>
      {/* ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ï¼‰ */}
      <HeroSection
        title={featured.data.title}
        headerImage={featured.data.headerImage}
        slug={featured.id}
        genres={featured.data.genres}
        reviewPercentage={featured.data.reviewPercentage}
      />

      {/* ã‚²ãƒ¼ãƒ ä¸€è¦§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
      <section class="games-section">
        <h2>ğŸ® ã‚²ãƒ¼ãƒ ä¸€è¦§</h2>
        <div class="grid">
          {otherGames.map((game) => (
            <GameCard
              slug={game.id}
              title={game.data.title}
              headerImage={game.data.headerImage}
              genres={game.data.genres}
              price={game.data.price}
              developer={game.data.developer}
              reviewScore={game.data.reviewScore}
              reviewPercentage={game.data.reviewPercentage}
            />
          ))}
        </div>
      </section>
    </>
  )}
</GameLayout>

<style>
  /* ã‚²ãƒ¼ãƒ ä¸€è¦§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
  .games-section {
    max-width: 1200px;
    margin: 3rem auto;
    padding: 0 1rem;
  }

  .games-section h2 {
    font-size: 1.8rem;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 3px solid var(--accent);
  }

  /* ã‚°ãƒªãƒƒãƒ‰ */
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
  }

  /* 0ä»¶æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ */
  .empty {
    text-align: center;
    padding: 4rem 1rem;
    font-size: 1.2rem;
  }

  /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–èª¿æ•´ */
  @media (max-width: 768px) {
    .grid {
      grid-template-columns: 1fr;
    }

    .games-section h2 {
      font-size: 1.5rem;
    }
  }
</style>
